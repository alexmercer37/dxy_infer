# dxy-inferé…ç½®
### locateçš„é—®é¢˜
ubuntuå¯ä»¥åˆ©ç”¨locateè¿›è¡Œç›®æ ‡æ–‡ä»¶å®šä½ï¼Œä½†åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å‡ºçŽ°äº†æ·»åŠ æˆ–è€…åˆ é™¤æ–‡ä»¶ä¸åŠæ—¶çš„é—®é¢˜ï¼Œéœ€è¦å¯¹æ•°æ®åº“è¿›è¡Œæ›´æ–°ï¼Œå› ä¸ºlocateæŒ‡ä»¤æ˜¯é’ˆå¯¹æ•°æ®åº“è¿è¡Œçš„
> https://blog.csdn.net/accumulate_zhang/article/details/77587136
### gcc,g++ç¼–è¯‘å™¨ä¸æ”¯æŒé—®é¢˜
ç”±äºŽå½“å‰çŽ¯å¢ƒéœ€è¦nvccä»¥åŠgcc,g++è”åˆç¼–è¯‘ï¼Œç³»ç»Ÿä¸º24.04ï¼Œé»˜è®¤å®‰è£…çš„gcc,g++ç‰ˆæœ¬å¾ˆé«˜ï¼Œæ˜¯13.2,è€Œå½“å‰åªæ”¯æŒå°äºŽ12ç‰ˆæœ¬çš„ç¼–è¯‘å™¨ï¼Œæ‰€ä»¥éœ€è¦å¯¹å…¶è¿›è¡Œé™çº§å¤„ç†ï¼Œcmakeç‰ˆæœ¬ç›®å‰æ˜¯3.28,ä¸è¿‡ç›®å‰æ¥çœ‹æ²¡æœ‰å¤ªå¤§å½±å“
> https://huanghailiang.github.io/2017/07/22/ubuntu-Reduce-the-version-gcc-g++/

> https://blog.csdn.net/CharlieVV/article/details/111242143
### undefined reference to é—®é¢˜è§£å†³
é¦–å…ˆæ€€ç–‘æ˜¯ç¼–è¯‘å™¨å†²çªï¼Œæ‰€ä»¥å¯¹nvccä¸Žc++ä½œäº†åˆ†å¼€å¤„ç†ï¼Œé¦–å…ˆå¯¹.cuæ–‡ä»¶ä½¿ç”¨nvccç¼–è¯‘å™¨è¿›è¡Œç¼–è¯‘ï¼Œç”Ÿæˆä¸€ä¸ªé™æ€é“¾æŽ¥åº“ï¼Œä¹‹åŽé€šè¿‡è°ƒç”¨é™æ€é“¾æŽ¥åº“ç¼–è¯‘.cppæ–‡ä»¶ï¼Œæ²¡æœ‰è§£å†³ï¼Œå…¶æ¬¡å‘çŽ°æ²¡æœ‰è¢«é“¾æŽ¥çš„å‡½æ•°å¹¶ä¸æ˜¯å…¨éƒ¨ï¼Œæ‰€ä»¥å¯¹äºŽä¸€éƒ¨åˆ†å‡½æ•°ä½œäº†å¤„ç†ï¼Œç›´æŽ¥åœ¨.hppæ–‡ä»¶ä¸­è¿›è¡Œå®šä¹‰ï¼Œéœ€è¦ç”¨inlineå‡½æ•°ï¼Œè§£å†³äº†ä¸€éƒ¨åˆ†é—®é¢˜ï¼Œä½†æ˜¯opencvçš„å‡½æ•°ä»ç„¶æœ‰ç›¸åŒæŠ¥é”™ï¼Œæ‰€ä»¥æ€€ç–‘æ˜¯opencvçš„ç‰ˆæœ¬é—®é¢˜ï¼ŒäºŽæ˜¯å°†ç‰ˆæœ¬ä»Ž4.9.0é™åˆ°äº†4.5.1,ä»ç„¶æ²¡æœ‰è§£å†³é—®é¢˜ï¼Œæœ€åŽåœ¨æŸ¥æ‰¾ç›¸å…³èµ„æ–™æ—¶å‘çŽ°å¯èƒ½æ˜¯cmakeçš„é…ç½®é—®é¢˜ï¼Œopencvçš„é…ç½®å’Œcudaçš„é…ç½®å¯èƒ½ä¸åŒ¹é…ï¼Œå¯¹cmakelists.txtè¿›è¡Œäº†ä¿®æ”¹ï¼Œå‘çŽ°é—®é¢˜è§£å†³äº†
> https://blog.csdn.net/LLY_A_/article/details/120385775

> https://mbd.baidu.com/ug_share/mbox/4a83aa9e65/share?product=smartapp&tk=e3c721c7f5214c2c21bcee5a54cecc3b&share_url=https%3A%2F%2Fyebd1h.smartapps.cn%2Fpages%2Fblog%2Findex%3FblogId%3D139819798%26_swebfr%3D1%26_swebFromHost%3Dbaiduboxapp&domain=mbd.baidu.com
### å®‰è£…opencv
é™ä½Žopencvç‰ˆæœ¬æ—¶ç¢°åˆ°äº†é—®é¢˜ï¼Œé¦–å…ˆæ˜¯cmakeè¿›è¡Œç¼–è¯‘æ—¶ä¸Žanacondaæœ‰å†²çªï¼Œå¯¼è‡´å®‰è£…ä¸äº†ï¼Œå¯ä»¥æš‚æ—¶å°†anacondaçš„å®‰è£…åŒ…åˆ é™¤ï¼Œå¯ä»¥è§£å†³å†²çªé—®é¢˜ï¼Œå…¶ä»–å‡ºçŽ°çš„é—®é¢˜è¯¦è§ä¸‹æ–¹ç½‘é¡µ
> https://blog.csdn.net/KIK9973/article/details/118830187

> https://blog.csdn.net/u010003609/article/details/100087245

> https://blog.csdn.net/CSDNWWC/article/details/129205596
### tensorRTç‰ˆæœ¬é—®é¢˜
ç›®å‰æ‰€ç”¨çš„ç‰ˆæœ¬æ˜¯8.6.1.6,å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œé«˜ç‰ˆæœ¬ç›®å‰æµ‹è¯•10.0ä»¥ä¸Šç‰ˆæœ¬æ— æ³•æ­£å¸¸è¿è¡Œï¼Œå®‰è£…çš„ç‰ˆæœ¬æ²¡æœ‰æŠ¥é”™å³å¯ä½¿ç”¨ã€‚æŠ¥é”™å¦‚ä¸‹
> class "nvinfer1::ICudaEngine" has no member "getNbBindings"
> 
> class "nvinfer1::ICudaEngine" has no member "bindingIsInput"
> 
> error: class "nvinfer1::ICudaEngine" has no member "getBindingName"
> 
> error: class "nvinfer1::ICudaEngine" has no member "getBindingDimensions"
### engineæ–‡ä»¶çš„ç”Ÿæˆ
ç›´æŽ¥ç”¨tensorRTå³å¯é€šè¿‡.onnxæ–‡ä»¶ç”Ÿæˆ.engineæ–‡ä»¶ï¼Œæ³¨æ„ä½¿ç”¨çš„æ–‡ä»¶ç›®å‰æ”¯æŒfp16ï¼Œä¸æ”¯æŒfp32ï¼Œæœ¬æž¶æž„æ”¯æŒyolov5,yolov7,yolov8,yolov8-segï¼Œå¯¹äºŽyolov5ï¼Œæœ‰æˆç†Ÿçš„ä¿®æ”¹åŽçš„å®‰è£…åŒ…ï¼Œå¯ä½œä¿åº•æ–¹æ¡ˆï¼Œä½†å¯¹äºŽç›®å‰çš„æ¯”èµ›æ¥è¯´æœ‰äº›è¿‡æ—¶ï¼ŒåŒ…æ‹¬ä»Šå¹´æ¯”èµ›çš„æŽ¨ç†çŽ¯å¢ƒä¹Ÿéœ€è¦æ›´æ–°ï¼Œæ‰€ä»¥ä»Šå¹´å¯ä»¥å°è¯•ç”¨æ­¤æŽ¨ç†çŽ¯å¢ƒå’Œyolov8è¿›è¡Œé¡¹ç›®æ­å»º
> https://blog.csdn.net/qq_43799400/article/details/134182459
### è¿è¡Œä»£ç æŠ¥é”™è§£å†³
- æŠ¥é”™Error Code 1: Cuda Runtime (an illegal memory access was encountered)ï¼ŒCUDA Runtime errorðŸ’¥ cudaFreeHost(cpu_) # an illegal memory access was encountered, code = cudaErrorIllegalAddress [ 700 ]
åŽŸå› æ˜¯åŠ è½½çš„engineçš„ç±»åž‹ä¸æ­£ç¡®ï¼ˆfp32ä¸æ”¯æŒï¼‰ï¼Œéœ€è¦åœ¨è®­ç»ƒæ—¶æŒ‡å®šç±»åž‹

- æŠ¥é”™CUDA Runtime errorðŸ’¥ cudaPeekAtLastError() # no kernel image is available for execution on the device, code = cudaErrorNoKernelImageForDevice [ 209 ]
åŽŸå› æ˜¯cmakelists.txtè®¾ç½®çš„gpuç®—åŠ›å’Œæœ¬ç”µè„‘çš„æ˜¾å¡gpuçš„ç®—åŠ›ä¸åŒ¹é…
> https://blog.csdn.net/FL1623863129/article/details/124207995
> https://en.wikipedia.org/wiki/CUDA#GPUs_supported
### çŽ¯å¢ƒé…ç½®
- æ˜¾å¡é©±åŠ¨rtx2060ï¼Œç‰ˆæœ¬535.183.01ï¼Œæœ€é«˜æ”¯æŒcuda12.2
- cuda12.2,cudnnå’Œcudaç‰ˆæœ¬åŒ¹é…å³å¯
  >https://blog.csdn.net/tangjiahao10/article/details/125225786
- opencv4.5.1ï¼Œé«˜ç‰ˆæœ¬åº”è¯¥ä¹Ÿé€‚é…
- pcl1.13.1ï¼Œç›®å‰æ²¡æœ‰æ·±å…¥è¿›è¡Œç¼–è¯‘æµ‹è¯•
- gcc,g++ç‰ˆæœ¬11.4,cmakeç‰ˆæœ¬3.28.3
- tensorRTç‰ˆæœ¬8.6.1.6
- gpuç®—åŠ›75
### ä½¿ç”¨æ–¹æ³•
- è¿›å…¥tensorRTçš„è·¯å¾„ï¼Œä¾‹å¦‚
  > /home/ddxy/project/TensorRT-8.6.1.6.Linux.x86_64-gnu.cuda-12.0/TensorRT-8.6.1.6/targets/x86_64-linux-gnu/bin 

- åˆ©ç”¨å¯æ‰§è¡Œæ–‡ä»¶trtexecå°†onnxæ–‡ä»¶è¿›è¡Œè½¬æ¢ï¼Œä¾‹å¦‚
  > ./trtexec --onnx=yolov8n.transd.onnx \
    --minShapes=images:1x3x640x640 \
    --maxShapes=images:16x3x640x640 \
    --optShapes=images:1x3x640x640 \
    --saveEngine=yolov8n.transd.engine

  > ./trtexec --onnx=yolov8n-seg.b1.transd.onnx \
    --saveEngine=yolov8n-seg.b1.transd.engine
- #### æ³¨æ„å…¶ä¸­çš„æŠ¥é”™æˆ–è€…è­¦å‘Š
- .ptæ–‡ä»¶è½¬æ¢onnxæ–‡ä»¶æ•™ç¨‹åŽç»­æ·»åŠ 
- å°†è½¬æ¢çš„.onnxé€šè¿‡tensorRTè½¬æ¢ä¸º.engineæ–‡ä»¶ï¼Œæ”¾åœ¨æŒ‡å®šè·¯å¾„ä¸‹ï¼Œé€šè¿‡å‡½æ•°loadå³å¯è°ƒç”¨
- å¯¹æ–‡ä»¶ä¸­çš„src/kernelsè¿›è¡Œå•ç‹¬ç¼–è¯‘ï¼Œç”Ÿæˆçš„libcu.aé™æ€é“¾æŽ¥åº“å¯ä»¥åœ¨buildæ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°ï¼Œå¤åˆ¶åˆ°workspaceæ–‡ä»¶å¤¹ä¸­ï¼Œä¹‹åŽåˆ é™¤buildæ–‡ä»¶å¤¹ï¼Œå¯¹è¯¥æ–‡ä»¶ä¸­çš„å¦ä¸€ä¸ªcmakelists.txtè¿›è¡Œç¼–è¯‘ï¼Œå¾—åˆ°å¯æ‰§è¡Œæ–‡ä»¶proï¼Œåœ¨workspaceæ–‡ä»¶å¤¹ä¸­ï¼Œè¿è¡Œå³å¯
- å¯ä»¥ä½¿ç”¨timeå‡½æ•°è¿›è¡Œé€Ÿåº¦æ£€æµ‹ï¼Œç»æµ‹è¯•ï¼Œé€Ÿåº¦å¯ä»¥è¾¾åˆ°0.5msä¸€æ¬¡æŽ¨ç†ï¼Œä½†ç”±äºŽç›¸æœºå¸§æ•°çš„é™åˆ¶ï¼Œåªèƒ½è¾¾åˆ°30å¸§çš„é€Ÿåº¦
### ä»£ç ä»‹ç»
- cpm.hppï¼šç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡åž‹ï¼Œå¯¹äºŽç›´æŽ¥æŽ¨ç†ä»»åŠ¡ï¼Œcpm.hpp å¯ä»¥è½¬å˜ä¸ºè‡ªåŠ¨å¤šæ‰¹æ¬¡ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡åž‹
- infer.hppï¼štensorRT çš„é‡æ–°åŒ…è£…ï¼ŒæŽ¥å£ç®€å•
- yolo.hppï¼šyolo ä»»åŠ¡çš„åŒ…è£…å™¨ã€‚åŸºäºŽ infer.hpp
---
# ç‰ˆæœ¬æ›´æ–°
### 8.17
- å¤šçº¿ç¨‹æ›´æ–°ï¼Œæ›´æ–°äº†è°ƒç”¨k4aç›¸æœºçš„çº¿ç¨‹ï¼Œé€šè¿‡çº¿ç¨‹æˆåŠŸè°ƒç”¨yolov8çš„ç›®æ ‡æ£€æµ‹å’Œåˆ†å‰²ï¼ŒåŒæ—¶æµ‹è¯•äº†è°ƒç”¨ç”µè„‘çš„åŽŸè£…ç›¸æœºçš„çº¿ç¨‹ï¼Œå¯¹å¤šçº¿ç¨‹åšäº†ä¸€å®šçš„å°è£…
  >https://immortalqx.github.io/2021/12/05/cpp-notes-4/
- ä¸²å£è°ƒç”¨çš„æ›´æ–°ï¼Œå°è£…äº†ä¸²å£çš„ç±»ï¼Œåœ¨ä¸»å‡½æ•°å†™å…¥äº†é€šè¿‡ä¸²å£æŽ¥å—ä¸åŒçš„æ¶ˆæ¯æ¥å¯åŠ¨ä¸åŒçš„çº¿ç¨‹
- æ›´æ–°äº†c++_pythonçš„è”åˆç¼–è¯‘ï¼ŒåŠ å…¥äº†è‡ªå·±æ­å»ºçš„pythonçŽ¯å¢ƒä¸‹çš„pytorchçš„ç›®æ ‡æ£€æµ‹æ–‡ä»¶
- æ›´æ–°äº†24å¹´ä¸Šè½¦çš„è‡ªå¯åŠ¨è„šæœ¬
- æ›´æ–°äº†tcpç½‘ç»œé€šä¿¡ï¼Œè¿›è¡Œäº†ç®€å•å°è£…ï¼Œå¹¶ä¸”åœ¨ä¸»å‡½æ•°ä¸­å¯ä»¥é€šè¿‡å¤šçº¿ç¨‹è°ƒç”¨
- åŠ å…¥äº†linuxçš„cané€šä¿¡ç›¸å…³å†…å®¹ï¼ŒåŠ å…¥äº†å¾ªçŽ¯é˜Ÿåˆ—ï¼Œé…åˆcané€šä¿¡çš„ä½¿ç”¨
- åˆ©ç”¨å®å®šä¹‰å¯¹ä»£ç è¿›è¡Œäº†æ³¨é‡Šï¼Œæ–¹ä¾¿è°ƒç”¨å’Œä¿®æ”¹
- è§£å†³äº†ç›¸æœºæ•°æ®çªç„¶ä¸¢å¤±ä½†æ˜¯ä¸é€€å‡ºè¿è¡Œçš„é—ç•™é—®é¢˜ï¼Œä¸»è¦é’ˆå¯¹æ·±åº¦å›¾ä¸¢å¤±å¯¼è‡´çš„rgbå›¾åƒçš„ä¸æ›´æ–°ï¼Œä»Žè€Œåªé’ˆå¯¹ä¸€å¼ å›ºå®šçš„å›¾ç‰‡è¿›è¡ŒæŽ¨ç†ï¼Œåˆ©ç”¨rgbè½¬ç°åº¦å›¾ï¼Œæ ‡å‡†åº“çš„å‡½æ•°å¯¹è¿žç»­ä¸¤å¼ ç°åº¦å›¾çš„å·®å¼‚è¿›è¡Œæ£€æµ‹ï¼Œåˆ¤å®šå¦‚æžœè¿žç»­åå¼ å›¾ç‰‡éƒ½ä¸å˜åŒ–ï¼Œåˆ™è®¤ä¸ºç›¸æœºä¸æ›´æ–°ï¼Œè¿›è€ŒæŠ›å‡ºå¼‚å¸¸ï¼Œä¸­æ–­ç¨‹åºï¼Œç­‰å¾…è‡ªå¯åŠ¨è„šæœ¬çš„é‡æ–°å¯åŠ¨ã€‚
- å¢žåŠ äº†ä¸€äº›æŠ›å¼‚å¸¸ï¼Œä½¿æ•´ä¸ªä»£ç æ›´åŠ ä¸¥è°¨ï¼Œæ›´æ–¹ä¾¿æ‰¾åˆ°é—®é¢˜æ‰€åœ¨
### 8.18
- æ›´æ–°yolov8çš„ä½¿ç”¨æ•™ç¨‹
  >https://github.com/ultralytics/ultralytics/tree/main?tab=readme-ov-file